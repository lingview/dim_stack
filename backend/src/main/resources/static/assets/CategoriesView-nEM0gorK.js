import{r as n,a as l,j as e}from"./index-BCEYEMy3.js";function $(){const[u,f]=n.useState([]),[b,p]=n.useState(!0),[j,o]=n.useState(!1),[c,h]=n.useState(null),[i,m]=n.useState({category_name:"",category_explain:""}),[r,d]=n.useState({});n.useEffect(()=>{x()},[]);const x=async()=>{try{p(!0);const t=await l.get("/tags-categories/categories");t.success&&f(t.data||[])}catch{}finally{p(!1)}},w=()=>{h(null),m({category_name:"",category_explain:""}),d({}),o(!0)},N=t=>{h(t),m({category_name:t.category_name,category_explain:t.category_explain}),d({}),o(!0)},v=async t=>{if(window.confirm("确定要删除这个分类吗？"))try{const s=await l.delete(`/tags-categories/categories/${t}`);s.success?(x(),alert("分类删除成功")):alert("分类删除失败: "+s.message)}catch{alert("删除分类失败")}},_=async t=>{try{const s=await l.put(`/tags-categories/categories/${t}/activate`);s.success?(x(),alert("分类激活成功")):alert("分类激活失败: "+s.message)}catch{alert("激活分类失败")}},C=async t=>{t.preventDefault();const s={};if(i.category_name.trim()||(s.category_name="分类名称不能为空"),i.category_explain.trim()||(s.category_explain="分类说明不能为空"),Object.keys(s).length>0){d(s);return}try{let a;c?a=await l.put(`/tags-categories/categories/${c.id}`,i):a=await l.post("/tags-categories/categories",i),a.success?(x(),o(!1),alert(c?"分类更新成功":"分类创建成功")):alert(c?"分类更新失败: "+a.message:"分类创建失败: "+a.message)}catch{alert("保存分类失败")}},y=t=>{const{name:s,value:a}=t.target;m(g=>({...g,[s]:a})),r[s]&&d(g=>({...g,[s]:""}))},k=t=>t===1?"启用":"禁用",S=t=>t===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return b?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"分类管理"}),e.jsx("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"新建分类"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"说明"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"创建者"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.category_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:t.category_explain}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.founder}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S(t.status)}`,children:k(t.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.status===1?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(t),className:"text-blue-600 hover:text-blue-900 mr-3",children:"编辑"}),e.jsx("button",{onClick:()=>v(t.id),className:"text-red-600 hover:text-red-900",children:"禁用"})]}):e.jsx("button",{onClick:()=>_(t.id),className:"text-green-600 hover:text-green-900",children:"激活"})})]},t.id))})]}),u.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"暂无分类数据"})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:c?"编辑分类":"新建分类"})}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category_name",className:"block text-sm font-medium text-gray-700",children:"分类名称"}),e.jsx("input",{type:"text",id:"category_name",name:"category_name",value:i.category_name,onChange:y,className:`mt-1 block w-full border ${r.category_name?"border-red-300":"border-gray-300"} rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`}),r.category_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.category_name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category_explain",className:"block text-sm font-medium text-gray-700",children:"分类说明"}),e.jsx("textarea",{id:"category_explain",name:"category_explain",rows:3,value:i.category_explain,onChange:y,className:`mt-1 block w-full border ${r.category_explain?"border-red-300":"border-gray-300"} rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`}),r.category_explain&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.category_explain})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"bg-white border border-gray-300 rounded-md shadow-sm py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"取消"}),e.jsx("button",{type:"submit",className:"bg-blue-600 border border-transparent rounded-md shadow-sm py-2 px-4 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"保存"})]})]})]})})]})}export{$ as default};
