import{r,a as m,j as e}from"./index-ZLa5ULTP.js";function L(){const[p,g]=r.useState([]),[y,b]=r.useState(!0),[d,u]=r.useState(null),[w,i]=r.useState(!1),[c,o]=r.useState({menus_name:"",menus_url:""}),[f,x]=r.useState(""),n=s=>s&&s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),l=s=>s&&s.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'");r.useEffect(()=>{h()},[]);const h=async()=>{try{b(!0);const s=await m.get("/getmenus");if(Array.isArray(s)){const t=s.map(a=>({...a,menus_name:n(a.menus_name)||"",menus_url:n(a.menus_url)||"",username:n(a.username)||""}));g(t)}else g([])}catch{x("获取菜单列表失败")}finally{b(!1)}},N=()=>{u(null),o({menus_name:"",menus_url:""}),i(!0)},_=s=>{u(s),o({menus_name:l(s.menus_name)||"",menus_url:l(s.menus_url)||""}),i(!0)},v=async s=>{if(window.confirm("确定要删除这个菜单项吗？"))try{await m.post("/deletemenus",null,{params:{menus_id:s}}),h()}catch{x("删除菜单失败")}},j=s=>{const{name:t,value:a}=s.target;o(C=>({...C,[t]:a}))},k=async s=>{s.preventDefault();try{const t={menus_name:n(c.menus_name),menus_url:n(c.menus_url)};d?await m.post("/editmenus",{menus_id:d.menus_id,menus_name:t.menus_name,menus_url:t.menus_url}):await m.post("/addmenus",{menus_name:t.menus_name,menus_url:t.menus_url}),i(!1),h()}catch{x("保存菜单失败")}},M=()=>{i(!1),u(null)};return y?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"菜单管理"})}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"菜单管理"}),e.jsxs("button",{onClick:N,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"添加菜单"]})]}),f&&e.jsx("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6",children:f}),w?e.jsxs("div",{className:"mb-6 p-6 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:d?"编辑菜单":"添加菜单"}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"菜单名称 *"}),e.jsx("input",{type:"text",name:"menus_name",value:c.menus_name,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"菜单URL *"}),e.jsx("input",{type:"text",name:"menus_url",value:c.menus_url,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"取消"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"保存"})]})]})]}):null,e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"菜单ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"菜单名称"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"菜单URL"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"创建用户"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.menus_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.menus_name)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.menus_url)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.username)||s.user_id||"未指定"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>_(s),className:"text-blue-600 hover:text-blue-900 mr-4",children:"编辑"}),e.jsx("button",{onClick:()=>v(s.menus_id),className:"text-red-600 hover:text-red-900",children:"删除"})]})]},s.menus_id))})]}),p.length===0&&!y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"暂无菜单"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"开始添加菜单项"})]})]})]})}export{L as default};
