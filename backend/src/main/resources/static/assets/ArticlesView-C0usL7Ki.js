import{c as p,r as n,a as x,j as e}from"./index-D41_mKPG.js";import{S as T}from"./square-pen-B4OqUxLX.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],A=p("eye-off",V);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],k=p("plus",q);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],I=p("send",F);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],U=p("trash-2",O);function G({onNewArticle:b,onEditArticle:M,articles:c,shouldRefresh:j,setShouldRefresh:v}){const[a,C]=n.useState(1),[l]=n.useState(10),[w,m]=n.useState(0),[i,u]=n.useState(0),[f,h]=n.useState([]),[_,g]=n.useState(!0);n.useEffect(()=>{d(a,l)},[a,l]),n.useEffect(()=>{j&&(d(a,l),v(!1))},[j,a,l,v]),n.useEffect(()=>{c&&Array.isArray(c.articles)&&(h(c.articles),m(c.total||0),u(c.totalPages||Math.ceil((c.total||0)/(c.size||l))),g(!1))},[c]);const d=async(t,s)=>{g(!0);try{const r=await x.get("/getarticlelist",{params:{page:t,size:s}});r.success&&r.data?(h(r.data.articles||[]),m(r.data.total||0),u(r.data.totalPages||Math.ceil((r.data.total||0)/s))):(h([]),m(0),u(0))}catch{h([]),m(0),u(0)}finally{g(!1)}},N=t=>t&&t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"),S=t=>{if(!t)return"未知日期";try{const s=new Date(t);if(isNaN(s.getTime()))return"日期格式错误";const r=s.getFullYear(),y=String(s.getMonth()+1).padStart(2,"0"),B=String(s.getDate()).padStart(2,"0"),D=String(s.getHours()).padStart(2,"0"),H=String(s.getMinutes()).padStart(2,"0");return`${r}-${y}-${B} ${D}:${H}`}catch{return"日期格式错误"}},z=t=>{switch(t){case 1:return"已发布";case 2:return"未发布";case 3:return"待审核";case 4:return"违规 - 请编辑后重新发布";default:return"未知"}},L=t=>{switch(t){case 1:return"bg-green-100 text-green-800";case 2:return"bg-yellow-100 text-yellow-800";case 3:return"bg-red-100 text-red-800";case 4:return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},o=t=>{t<1||t>i||C(t)},P=async t=>{if(window.confirm("确定要删除这篇文章吗？"))try{const s=await x.post("/deletearticle",{article_id:t});s.success?(alert("文章删除成功"),d(a,l)):alert(s.message||"删除失败")}catch{alert("删除文章时出错")}},$=async t=>{if(window.confirm("确定要取消发布这篇文章吗？"))try{const s=await x.post("/unpublisharticle",{article_id:t});s.success?(alert("文章已取消发布"),d(a,l)):alert(s.message||"取消发布失败")}catch{alert("取消发布文章时出错")}},R=async t=>{if(window.confirm("确定要发布这篇文章吗？"))try{const s=await x.post("/publisharticle",{article_id:t});s.success?(alert("文章已发布"),d(a,l)):alert(s.message||"发布失败")}catch{alert("发布文章时出错")}},E=async t=>{if(window.confirm("确定要移除这篇文章的密码吗？"))try{const s=await x.post("/removearticlepassword",{article_id:t});s.success?(alert("文章密码已移除"),d(a,l)):alert(s.message||"移除密码失败")}catch{alert("移除文章密码时出错")}};return _?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"文章管理"}),e.jsxs("button",{onClick:b,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"新建文章"]})]}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"文章管理"}),e.jsxs("button",{onClick:b,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"新建文章"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"标题"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"作者"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"日期"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f&&f.length>0?f.map((t,s)=>t?e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:N(t.article_name)||"无标题"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:N(t.author_name)||"未知作者"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:S(t.create_time)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${L(t.status)}`,children:z(t.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsxs("button",{onClick:()=>M(t.article_id),className:"text-blue-600 hover:text-blue-900 flex items-center mr-2",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"编辑"]}),t.status===1&&e.jsxs("button",{onClick:()=>$(t.article_id),className:"text-yellow-600 hover:text-yellow-900 flex items-center mr-2",children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"取消发布"]}),t.status===2&&e.jsxs("button",{onClick:()=>R(t.article_id),className:"text-green-600 hover:text-green-900 flex items-center mr-2",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"发布"]}),t.hasPassword&&e.jsxs("button",{onClick:()=>E(t.article_id),className:"text-purple-600 hover:text-purple-900 flex items-center mr-2",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"关闭密码"]}),e.jsxs("button",{onClick:()=>P(t.article_id),className:"text-red-600 hover:text-red-900 flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"删除"]})]})})]},t.article_id||s):null):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"暂无文章数据"})})})]})}),i>1&&e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>o(a-1),disabled:a===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"上一页"}),e.jsx("button",{onClick:()=>o(a+1),disabled:a===i,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"下一页"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["显示第 ",e.jsx("span",{className:"font-medium",children:(a-1)*l+1})," 到 ",e.jsx("span",{className:"font-medium",children:Math.min(a*l,w)})," 条结果，共 ",e.jsx("span",{className:"font-medium",children:w})," 条"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>o(1),disabled:a===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"首页"}),e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414zm-6 0a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 1.414L5.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})})]}),e.jsxs("button",{onClick:()=>o(a-1),disabled:a===1,className:"relative inline-flex items-center px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"上一页"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),(()=>{const s=[];for(let r=Math.max(2,a-2);r<=Math.min(i-1,a+2);r++)s.push(r);return a-2>2&&s.unshift("..."),a+2<i-1&&s.push("..."),[1,...s,i].map((r,y)=>e.jsx("button",{onClick:()=>typeof r=="number"&&o(r),disabled:r==="..."||r===a,className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${r===a?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":r==="..."?"text-gray-700":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"}`,children:r},y))})(),e.jsxs("button",{onClick:()=>o(a+1),disabled:a===i,className:"relative inline-flex items-center px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"下一页"}),e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]}),e.jsxs("button",{onClick:()=>o(i),disabled:a===i,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"末页"}),e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414zm6 0a1 1 0 011.414 0l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414-1.414L14.586 10l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})]})]})]})}export{G as default};
