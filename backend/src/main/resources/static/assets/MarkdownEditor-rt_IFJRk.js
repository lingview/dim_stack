import{c as C,r as d,a as f,j as e,g as K,M as q,b as J,d as X,e as Y,h as Q,i as D,o as ee}from"./index-vVIcK5_i.js";import{F as te,a as se,I as ae,L as re}from"./list-Cl0413kP.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],le=C("bold",oe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ie=C("code",ne);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M6 20V4",key:"1w1bmo"}],["path",{d:"M18 20V4",key:"o2hl4u"}]],de=C("heading",ce);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],ue=C("italic",me);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],pe=C("save",ge);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],he=C("video",xe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ye=C("x",fe);function be({articleData:o,onSave:F,onCancel:c,uploading:v}){const[n,g]=d.useState({title:"",cover:"",excerpt:"",tags:[],category:"",alias:"",password:""}),[y,_]=d.useState([]),[$,M]=d.useState([]),[I,z]=d.useState(!1),[j,O]=d.useState(!1),P=d.useRef(null);d.useEffect(()=>{T()},[]),d.useEffect(()=>{if(o){const a=o.password&&o.password.trim()!=="";O(a);let i=o.tag||o.tags||[];typeof i=="string"&&(i=i?i.split(",").map(m=>m.trim()):[]),g({title:o.article_name||o.title||"",cover:o.article_cover||o.cover||"",excerpt:o.excerpt||"",tags:i,category:o.category||"",alias:o.alias||"",password:""})}},[o]);const T=async()=>{try{const[a,i]=await Promise.all([f.get("/tags"),f.get("/categories")]);_(Array.isArray(a)?a:[]),M(Array.isArray(i)?i:[])}catch{_([]),M([])}},u=a=>{const{name:i,value:m,options:p,multiple:x}=a.target;let N=m;i==="tags"&&x&&(N=Array.from(p).filter(k=>k.selected).map(k=>k.value)),g(k=>({...k,[i]:N}))},E=async a=>{if(!a)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(a.type)){alert("仅支持 JPG、PNG、GIF、WebP 格式的图片");return}if(a.size>5*1024*1024){alert("封面图片大小不能超过 5MB");return}z(!0);try{const m=new FormData;m.append("file",a);const p=await f.post("/uploadattachment",m,{headers:{"Content-Type":"multipart/form-data"}});g(x=>({...x,cover:p.fileUrl||""}))}catch(m){alert("封面上传失败: "+(m.response?.data?.error||m.message))}finally{z(!1)}},R=()=>{P.current?.click()},S=a=>{const i=a.target.files?.[0];i&&E(i),a.target.value=""},U=()=>{if(!n.title.trim()){alert("请输入文章标题");return}if(!n.category){alert("请选择文章分类");return}const a={...o,title:n.title,cover:n.cover,excerpt:n.excerpt,tags:Array.isArray(n.tags)?n.tags.join(","):n.tags,category:n.category,alias:n.alias};o?.article_id?n.password.trim()!==""&&(a.password=n.password):a.password=n.password,F(a)},L=a=>a?a.startsWith("http://")||a.startsWith("https://")?a:K().getFullUrl(a):"";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:c}),e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden z-10 transform transition-all sm:my-8 sm:w-full sm:max-w-lg pointer-events-auto",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 article-header-bg px-6 py-4 border-b border-gray-200 ",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 article-header-title",children:o?.article_id?"编辑文章":"新建文章"}),e.jsx("p",{className:"text-gray-600 article-header-subtitle text-sm mt-1",children:o?.article_id?"修改文章信息":"请填写文章的基本信息"})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700  mb-2",children:["文章标题 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"title",value:n.title,onChange:u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900 ",placeholder:"请输入文章标题"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700  mb-2",children:"文章封面"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"text",name:"cover",value:n.cover,onChange:u,className:"flex-1 px-4 py-2 border border-gray-300  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900",placeholder:"请输入封面图片URL或上传图片"}),e.jsx("button",{onClick:R,disabled:I,className:"px-4 py-2 bg-gray-100  text-gray-700  rounded-lg hover:bg-gray-200  disabled:opacity-50 transition flex items-center",children:I?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-700 ",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"上传中..."]}):"上传"}),e.jsx("input",{ref:P,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:S,className:"hidden"})]}),n.cover&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-gray-500  mb-1",children:"封面预览:"}),e.jsx("div",{className:"flex items-center",children:e.jsx("img",{src:L(n.cover),alt:"封面预览",className:"h-20 w-32 object-cover rounded-lg border border-gray-200  shadow-sm",onError:a=>{a.target.src="/image_error.svg"}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文章摘要"}),e.jsx("textarea",{name:"excerpt",value:n.excerpt,onChange:u,rows:4,className:"w-full px-4 py-2 border border-gray-300  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900 ",placeholder:"请输入文章摘要，用于文章列表页显示和SEO优化"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 ",children:"简要描述文章内容，建议控制在150字以内，用于文章列表页显示和SEO优化"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700  mb-2",children:["文章分类 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"category",value:n.category,onChange:u,className:"w-full px-4 py-2 border border-gray-300  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900 ",children:[e.jsx("option",{value:"",className:"text-gray-900  bg-white ",children:"请选择分类"}),$.map(a=>e.jsx("option",{value:a.article_categories||a,className:"text-gray-900  bg-white ",children:a.article_categories||a},a.id||a.article_categories))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文章标签"}),e.jsxs("div",{className:"flex flex-wrap gap-2 p-2 border border-gray-300 rounded-lg min-h-[40px] bg-white",children:[y.map(a=>{const i=a.tag_name||a,m=Array.isArray(n.tags)&&n.tags.includes(i);return e.jsx("button",{type:"button",onClick:()=>{g(p=>{const x=p.tags||[];return x.includes(i)?{...p,tags:x.filter(N=>N!==i)}:{...p,tags:[...x,i]}})},className:`px-3 py-1 text-sm rounded-full transition ${m?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:i},a.id||i)}),y.length===0&&e.jsx("span",{className:"text-gray-400 text-sm",children:"暂无可用标签"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"点击标签进行选择或取消"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700  mb-2",children:"文章别名"}),e.jsx("input",{type:"text",name:"alias",value:n.alias,onChange:u,className:"w-full px-4 py-2 border border-gray-300  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900 ",placeholder:"用于生成文章访问链接，如不填写将自动生成"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 ",children:"只能包含字母、数字、连字符(-)和下划线(_)，用于生成文章的访问链接"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700  mb-2",children:["文章密码",j&&e.jsx("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:"已设置密码"})]}),e.jsx("input",{type:"password",name:"password",value:n.password,onChange:u,className:"w-full px-4 py-2 border border-gray-300  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white  text-gray-900",placeholder:o?.article_id&&j?"留空保持原密码，输入新密码则更新":"请输入文章访问密码，留空则无需密码"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 ",children:o?.article_id?j?"当前文章已设置密码，留空则保持原密码不变，输入新密码则更新密码":"当前文章无密码保护，输入密码可为文章设置访问密码":"设置密码后，用户需要输入密码才能访问文章内容"})]})]})}),e.jsxs("div",{className:"bg-gray-50  px-6 py-4 flex justify-end space-x-3",children:[e.jsx("button",{onClick:c,disabled:v,className:"px-5 py-2 text-gray-700  bg-white  border border-gray-300  rounded-lg hover:bg-gray-50 disabled:opacity-50 transition",children:"取消"}),e.jsx("button",{onClick:U,disabled:v,className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition flex items-center",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"保存中..."]}):o?.article_id?"更新文章":"保存文章"})]})]})]})}const we={tagNames:["div","span","p","br","strong","em","u","s","del","ins","h1","h2","h3","h4","h5","h6","ul","ol","li","dl","dt","dd","blockquote","pre","code","table","thead","tbody","tr","th","td","a","img","video","audio","source","track","hr","sup","sub"],attributes:{"*":["className","id","style"],a:["href","title","target","rel"],img:["src","alt","title","width","height"],video:["src","controls","autoplay","loop","muted","poster","width","height","preload"],audio:["src","controls","autoplay","loop","muted","preload"],source:["src","type","media"],track:["src","kind","srclang","label","default"]}},A={image:["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","image/bmp"],video:["video/mp4","video/webm","video/ogg","video/avi","video/mov","video/mkv"],audio:["audio/mp3","audio/mpeg","audio/wav","audio/ogg","audio/m4a","audio/aac","audio/flac"]},ve={bold:"**粗体**",italic:"*斜体*",link:"[描述](https://)",image:"![alt](https://)",list:"- 列表项",code:'\n```js\nconsole.log("Hello World");\n```\n'},W=[{type:"bold",icon:le,title:"粗体"},{type:"italic",icon:ue,title:"斜体"},{type:"heading",icon:de,title:"标题"},{type:"link",icon:se,title:"链接"},{type:"image",icon:ae,title:"插入图片",isFile:!0},{type:"video",icon:he,title:"插入视频",isFile:!0},{type:"audio",icon:q,title:"插入音频",isFile:!0},{type:"list",icon:re,title:"列表"},{type:"code",icon:ie,title:"代码"}],je=o=>{for(const[F,c]of Object.entries(A))if(c.includes(o))return F;return null},B=o=>Object.values(A).flat().includes(o),H=o=>o&&(o.startsWith("http://")||o.startsWith("https://"));function Ce({onSave:o,onCancel:F,initialData:c}){const[v,n]=d.useState(c?.article_name||""),[g,y]=d.useState(c?.article_content||""),[_,$]=d.useState(!1),[M,I]=d.useState(!1),[z,j]=d.useState(!1),[O,P]=d.useState(null),[T,u]=d.useState(!1),E=d.useRef(null),R=d.useRef(null),S=d.useRef(null),U=d.useRef(new Set);d.useEffect(()=>{c&&(n(c.article_name||""),y(c.article_content||""))},[c]),d.useEffect(()=>{const t=async l=>{const h=l.clipboardData?.items;if(h){for(const b of h)if(b.kind==="file"){l.preventDefault();const w=b.getAsFile();w&&await N(w);break}}},s=l=>{E.current&&!E.current.contains(l.target)&&u(!1)},r=R.current;return r?.addEventListener("paste",t),document.addEventListener("mousedown",s),()=>{r?.removeEventListener("paste",t),document.removeEventListener("mousedown",s)}},[]);const L=()=>{if(!v.trim()||!g.trim()){alert("标题和内容不能为空");return}P({title:v,content:g,id:c?.article_id,cover:c?.article_cover||"",excerpt:c?.excerpt||"",tags:c?.tag||c?.tags||[],category:c?.category||"",alias:c?.alias||"",password:c?.password||""}),j(!0)},a=async t=>{$(!0),j(!1);try{const s={article_name:t.title,article_content:t.content,article_cover:t.cover||"",excerpt:t.excerpt||"",password:t.password||"",tag:t.tags||"",category:t.category||"",alias:t.alias||"",status:2,...t.id&&{article_id:t.id}},r=c&&c.article_id;let l;if(r?l=await f.post("/updatearticle",s):l=await f.post("/uploadarticle",s),l.success===!0||l.message)o(t);else throw new Error(l.message||l.error||"操作失败")}catch(s){let r="请重试";s.response?.data?.error?r=s.response.data.error:s.response?.data?.message?r=s.response.data.message:s.message&&s.message!=="请重试"&&(r=s.message),alert(`保存失败: ${r}`)}finally{$(!1)}},i=t=>{const s=ve[t];s&&y(r=>r+(r.endsWith(`
`)?"":`
`)+s)},m=t=>{W.find(r=>r.type===t)?.isFile?p(t):t==="heading"?u(r=>!r):i(t)},p=t=>{if(!S.current)return;const s=t==="image"||t==="video"||t==="audio"?A[t].join(","):Object.values(A).flat().join(",");S.current.accept=s,S.current.click()},x=t=>{const s=t.target.files?.[0];s&&N(s),t.target.value=""},N=async t=>{if(!t||!B(t.type)){B(t.type)||alert(`不支持的文件类型: ${t.type}

仅支持: ${Object.values(A).flat().join(", ")}`);return}const s=`${t.name}-${t.size}-${t.lastModified}`;if(!U.current.has(s)){U.current.add(s),I(!0);try{const r=t.size>10485760?await G(t):await k(t);if(r){const l=K().getFullUrl(r),h=je(t.type),w={image:`
![${t.name}](${l})
`,video:`
<video src="${l}" controls style="width: 400px;"></video>
`,audio:`
<audio src="${l}" controls preload="metadata"></audio>
`}[h];w&&y(V=>V+w)}}catch(r){alert("文件上传失败: "+r.message)}finally{U.current.delete(s),I(!1)}}},k=async t=>{const s=new FormData;s.append("file",t);try{return(await f.post("/uploadattachment",s,{headers:{"Content-Type":"multipart/form-data"}})).fileUrl}catch(r){throw new Error("普通上传失败: "+(r.response?.data?.error||r.message))}},G=async t=>{const r=Math.ceil(t.size/5242880);try{const{uploadId:l}=await f.post("/uploadattachment/init",{filename:t.name});for(let b=0;b<r;b++){const w=b*5242880,V=t.slice(w,Math.min(w+5242880,t.size));await f.post("/uploadattachment/part",V,{headers:{"Upload-Id":l,"Chunk-Index":b,"Content-Type":"application/octet-stream"}})}const{fileUrl:h}=await f.post("/uploadattachment/complete",{uploadId:l,filename:t.name});return h}catch(l){throw new Error("分片上传失败: "+(l.response?.data?.error||l.message))}},Z={h1:t=>e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4 ",...t}),h2:t=>e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3 ",...t}),h3:t=>e.jsx("h3",{className:"text-xl font-semibold mt-4 mb-2 ",...t}),h4:t=>e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2 ",...t}),p:t=>e.jsx("p",{className:"mb-3 leading-relaxed text-gray-700 ",...t}),ul:t=>e.jsx("ul",{className:"list-disc list-inside mb-3 text-gray-700 ",...t}),ol:t=>e.jsx("ol",{className:"list-decimal list-inside mb-3 text-gray-700 ",...t}),li:t=>e.jsx("li",{className:"mb-1 text-gray-700 ",...t}),blockquote:t=>e.jsx("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic my-3 text-gray-600 ",...t}),code({className:t,children:s,...r}){const l=/language-(\w+)/.exec(t||"");return l?e.jsx(D,{style:ee,language:l[1],PreTag:"div",...r,children:String(s).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100  px-1 py-0.5 rounded text-sm font-mono text-gray-800 dark:text-white",...r,children:s})},a:({href:t,children:s,...r})=>H(t)?e.jsx("a",{href:t,className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-500 dark:hover:text-blue-300",target:"_blank",rel:"noopener noreferrer",...r,children:s}):e.jsx("span",{...r,children:s}),img:({src:t,alt:s,...r})=>H(t)?e.jsx("img",{src:t,alt:s,className:"rounded-lg shadow-sm my-4 block cursor-pointer border border-gray-200",style:{maxHeight:"300px",maxWidth:"400px",height:"auto",width:"auto",objectFit:"contain"},onClick:()=>window.open(t,"_blank"),title:"点击查看大图",...r}):null,audio:({src:t,controls:s=!0,preload:r="metadata",...l})=>{if(!H(t))return null;const h=t.split("/").pop()?.split("?")[0]||"音频文件";return e.jsxs("div",{className:"inline-block my-4 p-4 bg-gray-100  border border-gray-200 rounded-xl shadow-sm max-w-lg",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center mr-3",children:e.jsx(q,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900  truncate",title:h,children:h}),e.jsx("div",{className:"text-xs text-gray-500 ",children:"音频文件"})]})]}),e.jsx("audio",{src:t,controls:s,preload:r,className:"w-full rounded-md",style:{height:"40px",outline:"none"},...l})]})},source:({src:t,type:s,...r})=>H(t)?e.jsx("source",{src:t,type:s,...r}):null};return e.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col",children:[e.jsxs("div",{className:"border-b border-gray-200 p-4 flex items-center justify-between bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-6 w-6 text-blue-600"}),e.jsx("input",{type:"text",value:v,onChange:t=>n(t.target.value),placeholder:"请输入文章标题",className:"text-xl font-semibold border-none focus:outline-none focus:ring-0 p-0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[M&&e.jsx("div",{className:"text-sm text-blue-600",children:"文件上传中..."}),e.jsxs("button",{onClick:F,className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"取消"]}),e.jsxs("button",{onClick:L,disabled:_||M,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),_?"保存中...":"保存"]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 flex flex-col border-r border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between border-b border-gray-200 bg-gray-50 px-2 markdown-editor-toolbar",children:W.map(t=>e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("button",{onClick:()=>m(t.type),title:t.title,className:"p-2 sm:p-3 hover:bg-gray-100 rounded w-12 h-12 flex items-center justify-center sm:w-10 sm:h-10",children:e.jsx(t.icon,{className:"h-5 w-5 sm:h-4 sm:w-4"})}),t.type==="heading"&&T&&e.jsx("div",{ref:E,className:"absolute top-full left-0 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 z-10 heading-menu",children:["# 一级标题","## 二级标题","### 三级标题"].map((s,r)=>e.jsx("button",{onClick:()=>{y(l=>l+`
`+s+`
`),u(!1)},className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-sm",children:s},r))})]},t.type))}),e.jsx("textarea",{ref:R,value:g,onChange:t=>y(t.target.value),placeholder:"在此输入 Markdown 内容...",className:"flex-1 p-4 focus:outline-none font-mono resize-none text-gray-900 bg-white ",spellCheck:!1})]}),e.jsx("div",{className:"w-1/2 p-4 overflow-y-auto bg-white text-gray-900",children:e.jsx(J,{children:g,remarkPlugins:[Q],rehypePlugins:[X,[Y,we]],components:Z})})]}),e.jsx("input",{type:"file",ref:S,className:"hidden",onChange:x}),z&&e.jsx(be,{articleData:O,onSave:a,onCancel:()=>j(!1),uploading:_})]})}export{Ce as default};
