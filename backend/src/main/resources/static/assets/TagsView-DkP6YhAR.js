import{r as n,a as c,j as e}from"./index-Cld2kMbo.js";function E(){const[u,b]=n.useState([]),[y,p]=n.useState(!0),[j,d]=n.useState(!1),[i,h]=n.useState(null),[l,m]=n.useState({tag_name:"",tag_explain:""}),[r,o]=n.useState({});n.useEffect(()=>{x()},[]);const x=async()=>{try{p(!0);const t=await c.get("/tags-categories/tags");t.success&&b(t.data||[])}catch{}finally{p(!1)}},w=()=>{h(null),m({tag_name:"",tag_explain:""}),o({}),d(!0)},N=t=>{h(t),m({tag_name:t.tag_name,tag_explain:t.tag_explain}),o({}),d(!0)},v=async t=>{if(window.confirm("确定要删除这个标签吗？"))try{const s=await c.delete(`/tags-categories/tags/${t}`);s.success?(x(),alert("标签删除成功")):alert("标签删除失败: "+s.message)}catch{alert("删除标签失败")}},_=async t=>{try{const s=await c.put(`/tags-categories/tags/${t}/activate`);s.success?(x(),alert("标签激活成功")):alert("标签激活失败: "+s.message)}catch{alert("激活标签失败")}},k=async t=>{t.preventDefault();const s={};if(l.tag_name.trim()||(s.tag_name="标签名称不能为空"),l.tag_explain.trim()||(s.tag_explain="标签说明不能为空"),Object.keys(s).length>0){o(s);return}try{let a;i?a=await c.put(`/tags-categories/tags/${i.id}`,l):a=await c.post("/tags-categories/tags",l),a.success?(x(),d(!1),alert(i?"标签更新成功":"标签创建成功")):alert(i?"标签更新失败: "+a.message:"标签创建失败: "+a.message)}catch{alert("保存标签失败")}},f=t=>{const{name:s,value:a}=t.target;m(g=>({...g,[s]:a})),r[s]&&o(g=>({...g,[s]:""}))},C=t=>t===1?"启用":"禁用",S=t=>t===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"标签管理"}),e.jsx("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"新建标签"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"标签名称"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"说明"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"创建者"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.tag_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:t.tag_explain}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.founder}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S(t.status)}`,children:C(t.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.status===1?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(t),className:"text-blue-600 hover:text-blue-900 mr-3",children:"编辑"}),e.jsx("button",{onClick:()=>v(t.id),className:"text-red-600 hover:text-red-900",children:"禁用"})]}):e.jsx("button",{onClick:()=>_(t.id),className:"text-green-600 hover:text-green-900",children:"激活"})})]},t.id))})]}),u.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"暂无标签数据"})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"编辑标签":"新建标签"})}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tag_name",className:"block text-sm font-medium text-gray-700",children:"标签名称"}),e.jsx("input",{type:"text",id:"tag_name",name:"tag_name",value:l.tag_name,onChange:f,className:`mt-1 block w-full border ${r.tag_name?"border-red-300":"border-gray-300"} rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`}),r.tag_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.tag_name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tag_explain",className:"block text-sm font-medium text-gray-700",children:"标签说明"}),e.jsx("textarea",{id:"tag_explain",name:"tag_explain",rows:3,value:l.tag_explain,onChange:f,className:`mt-1 block w-full border ${r.tag_explain?"border-red-300":"border-gray-300"} rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`}),r.tag_explain&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.tag_explain})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"bg-white border border-gray-300 rounded-md shadow-sm py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"取消"}),e.jsx("button",{type:"submit",className:"bg-blue-600 border border-transparent rounded-md shadow-sm py-2 px-4 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"保存"})]})]})]})})]})}export{E as default};
